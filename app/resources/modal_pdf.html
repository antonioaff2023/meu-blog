<!--[main]-->
<div class='modal' id='modalPDF' tabindex='-1' style="display: block; background: rgba(0,0,0,0.5);">
    <div style='width: 80%; margin: 30px auto;'>
        <div class='modal-content'>
            <div class='modal-header d-flex justify-content-between'>
                <h5 class='modal-title'>Arquivo para exportação ou download</h5>
                <button style='color: red'type='button' class='btn-close re' id='btnFecharModal' aria-label='Close'></button>
            </div>
            <div class='modal-body'>
                <object data="{$file}" type='application/pdf' style='width: 100%; height: 85vh'>
                    O navegador não suporta a exibição... <a href="{$file}">baixar</a>
                </object>
            </div>
        </div>
    </div>
</div>

<script>
    // Função única para fechar o modal
    function fecharEsteModal() {
        $('#modalPDF').hide();
        $('.modal-backdrop').remove();
        // Remove o evento de teclado para não pesar na página depois de fechar
        $(document).off('keydown.meuModal');
    }

    // 1. Fechar pelo clique no botão
    $(document).off('click', '#btnFecharModal').on('click', '#btnFecharModal', function () {
        fecharEsteModal();
    });

    // 2. Fechar pela tecla ESC
    $(document).on('keydown.meuModal', function (e) {
        if (e.key === "Escape" || e.keyCode === 27) {
            fecharEsteModal();
        }
    });

    // 3. Forçar o foco para o modal (Ajuda o ESC a funcionar com o PDF)
    $('#modalPDF').focus();
</script>
<!--[/main]-->